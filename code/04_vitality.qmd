---
title: "Vitality"
author: "Stefano Coretta"
format: html
---

```{r}
#| label: setup

library(tidyverse)
```

## Read data

```{r}
#| label: polentometro
polentometro <- readRDS("data/derived/polentometro.rds")

polentometro_page8 <- polentometro |> 
  filter(MAXPAGE > 7) |> 
  mutate(
    understand_galloit_birth = ifelse(is.na(understand_galloit_birth), as.character(understand), as.character(understand_galloit_birth)),
    understand_galloit_birth = factor(understand_galloit_birth, levels = c("No, per niente", "Sì, ma molto poco", "Così così", "Sì, lo capisco", "Sì, lo capisco molto bene")),
    speak_galloit_birth = ifelse(is.na(speak_galloit_birth), as.character(speak), as.character(speak_galloit_birth)),
    speak_galloit_birth = factor(speak_galloit_birth, levels = c("No, per niente", "Sì, ma molto poco", "Così così", "Sì, lo parlo bene", "Sì, lo parlo molto bene"))
  )
```

```{r}
polentometro_page8 |> 
  drop_na(understand_galloit_birth) |> 
  ggplot(aes(understand_galloit_birth)) +
  geom_bar() +
  coord_flip()

polentometro_page8 |> 
  drop_na(understand_galloit_birth) |> 
  filter(Region != "Veneto") |> 
  ggplot(aes(understand_galloit_birth)) +
  geom_bar() +
  coord_flip() +
  facet_wrap(vars(Region))
```

```{r}
polentometro_page8 |> 
  drop_na(speak_galloit_birth) |> 
  ggplot(aes(speak_galloit_birth)) +
  geom_bar() +
  coord_flip() +
  facet_wrap(vars(Region))

polentometro_page8 |> 
  drop_na(speak_galloit_birth) |> 
  ggplot(aes(Region, fill = speak_galloit_birth)) +
  geom_bar(position = "fill") +
  coord_flip() +
  scale_fill_brewer(type = "div")

polentometro_page8 |> 
  drop_na(speak_galloit_birth) |> 
  ggplot(aes(Area, fill = speak_galloit_birth)) +
  geom_bar(position = "fill") +
  coord_flip() +
  scale_fill_brewer(type = "div")
```
