---
title: "01 - Process data"
author: "Stefano Coretta"
format: html
---

```{r}
#| label: packages
#| message: false

source("code/scripts/packages.R")

```

## Get comuni

```{r comuni}
library(readxl)
comuni <- read_excel("data/Elenco-comuni-italiani.xls")

comuni_include <- comuni %>%
  filter(
    `Denominazione Regione` %in% c("Piemonte", "Valle d'Aosta/Vallée d'Aoste", "Lombardia", "Trentino-Alto Adige/Südtirol", "Veneto", "Friuli-Venezia Giulia", "Liguria", "Emilia-Romagna")
  )

comuni_svizzera <- read_lines("data/comuni-svizzera.txt")

comuni_all <- sort(c(comuni_include$`Denominazione in italiano`, comuni_svizzera))

write_lines(comuni_all, "data/comuni.txt")
```

## Read data

We can read the data from SosciSurvey using the SosciSurvey API, which has been enabled for this project. No credentials are necessary.

```{r}
#| label: read-data
#| message: false

source("code/scripts/import_galloitalico_2023-01-28_11-52.R")
write_csv(gi_vital, "data/gi_vital.csv")
```

```{r}
#| label: cases

range(gi_vital$CASE)
length(unique(gi_vital$CASE))

```
